/*! HtmlInColumns 22-10-2017 */
var Logger=Logger||function(){"use strict";var a=new Object;return a.stopwatchStartTime=null,a.screenLogHtml="",a.gotConsole=!0,a.useAlertAsAlternertive=!1,a.useScreenLog=!1,a.traceAllLogs=!1,Object.defineProperty(a,"LOG_NONE",{value:0,writeable:!1}),Object.defineProperty(a,"LOG_ERROR",{value:1,writeable:!1}),Object.defineProperty(a,"LOG_ERROR_WARN",{value:2,writeable:!1}),Object.defineProperty(a,"LOG_ERROR_WARN_INFO",{value:3,writeable:!1}),Object.defineProperty(a,"LOG_ALL",{value:4,writeable:!1}),a.logLevel=a.LOG_ALL,a.screenLogCss="#ScreenLogger{\r\nposition:fixed;\r\ntop:0px;\r\nbottom:0px;\r\nright:0px;\r\nwidth:250px;\r\nbackground-color:rgba(0,0,0,.6);\r\npadding:10px;\r\noverflow-y:auto;\r\noverflow-x:hidden;\r\n}\r\n#ScreenLogger div{\r\ncolor:rgba(255,255,255,0.8);\r\n}\r\n#ScreenLogger div.warn{\r\ncolor:rgba(255,255,0,0.8);\r\n}\r\n#ScreenLogger div.error{\r\ncolor:rgba(255,0,0,0.8);\r\n}\r\n#ScreenLogger .logGroup{\r\npadding-left:10px;\r\nborder-bottom:1px solid rgba(255,255,255,0.8);\r\nborder-top:1px solid rgba(255,255,255,0.8);\r\n}",a.log=function(b){a.logLevel<a.LOG_ALL||a.doLog(b,"debug")},a.doLog=function(b,c){if(a.gotConsole)if(a.traceAllLogs&&"undefined"!=typeof console.trace)console.trace(b);else if("undefined"!=typeof console[c])try{console[c](b)}catch(a){alert(a)}else"undefined"!=typeof console.log?console.log(b):a.useAlertAsAlternertive&&alert(b);else a.useAlertAsAlternertive&&alert(b);a.screenLog(b,c)},a.trace=function(b){a.logLevel<a.LOG_ALL||a.doLog(b,"trace")},a.debug=function(b){!a.logLevel!=a.LOG_ALL&&a.doLog(b,"debug")},a.info=function(b){a.logLevel<a.LOG_ERROR_WARN_INFO||a.doLog(b,"info")},a.warn=function(b){a.logLevel<a.LOG_ERROR_WARN||a.doLog(b,"warn")},a.error=function(b){a.logLevel<a.LOG_ERROR||a.doLog(b,"error")},a.screenLog=function(b,c){if(a.useScreenLog&&a.gotJquery()){a.createScreenLogDiv();var d=c?' class="'+c+'"':"";a.appendScreenLogHtml("<div"+d+">"+b+"</div>")}},a.createScreenLogDiv=function(){if(null==document.getElementById("ScreenLogger"))try{jQuery("body").append("<div id='ScreenLogger'></div>"),a.appendScreenLogHtml("<div><b>LOG</b></div>"),jQuery("head").append("<style>"+a.screenLogCss+"</style>")}catch(a){}},a.gotJquery=function(){return"undefined"!=typeof window.jQuery},a.group=function(b){a.gotConsole&&"undefined"!=typeof console.group&&console.group(b),a.screenGroup(b)},a.groupCollapsed=function(b){a.gotConsole&&"undefined"!=typeof console.groupCollapsed&&console.groupCollapsed(b),a.screenGroup(b)},a.screenGroup=function(b){a.useScreenLog&&a.gotJquery()&&(a.screenLog("<b>"+b+"</b>"),a.appendScreenLogHtml('<div class="logGroup">'))},a.groupEnd=function(){a.gotConsole&&"undefined"!=typeof console.groupEnd&&console.groupEnd(),a.useScreenLog&&a.gotJquery()&&a.appendScreenLogHtml("</div>")},a.assert=function(b,c){a.gotConsole&&"undefined"!=typeof console.assert?(console.assert(b,c),a.screenLog(c)):b&&(a.doLog(c),a.screenLog(c))},a.appendScreenLogHtml=function(b){a.screenLogHtml+=b;try{jQuery("#ScreenLogger").html(a.screenLogHtml)}catch(a){}},a.count=function(b){a.gotConsole&&"undefined"!=typeof console.count&&console.count(b)},a.startStopwatch=function(){a.stopwatchStartTime=performance.now()},a.resetStopwatch=function(){a.startStopwatch()},a.stopStopwatch=function(){a.stopwatchStartTime=null},a.logStopwatch=function(b){null==b&&(b="Elapsed time"),null==a.stopwatchStartTime&&a.startStopwatch(),a.log(b+" = "+(performance.now()-a.stopwatchStartTime)+" ms")},a.getStopwatch=function(){return null==a.stopwatchStartTime&&a.startStopwatch(),performance.now()-a.stopwatchStartTime},a.logLoadPerformance=function(){function b(a){var b=1;return"-"===a[0]&&(b=-1,a=a.substr(1)),function(c,d){var e=c[a]<d[a]?-1:c[a]>d[a]?1:0;return e*b}}if(window.performance&&window.performance.timing){a.group("Load performance");var c=window.performance.timing.navigationStart,d=[{key:"Start",time:0}];for(var e in window.performance.timing)null!=window.performance.timing[e]&&window.performance.timing[e]>0&&d.push({key:e,time:window.performance.timing[e]-c});d.sort(b("time"));for(var f=0;f<d.length;f++)a.log(d[f].key+" = "+d[f].time);a.groupEnd()}},a.toString=function(){return"[object Logger]"},window?"undefined"==typeof window.console&&(a.gotConsole=!1,window.console={log:function(){}}):a.gotConsole=!1,a}(),Arrays=Arrays||function(){var a=new Object;a.contains=function(a,b){var c=0,d=a.length;for(c=0;c<d;c++)if(b===a[c])return c;return-1},a.remove=function(b,c,d){null==d&&(d=!0),d&&(b=a.removeDuplicates(b));var e=a.contains(b,c);return e!=-1&&(b.splice(e,1),!0)},a.removeDuplicates=function(a){var b=[],c=!1,d=0,e=0,f=null;for(d=0;d<a.length;d++){for(f=a[d],c=!1,e=0;e<b.length;e++)if(f===b[e]){c=!0;break}c||b.push(f)}return b},a.randomize=function(a){var b,c,d,e=a.length;if(0===e)return a;for(;--e;)b=Math.floor(Math.random()*(e+1)),c=a[e],d=a[b],a[e]=d,a[b]=c;return a},a.fromObject=function(a){var b,c=[];for(b in a)c.push(a[b]);return c},a.clone=function(a){return a.slice(0)},a.extendArray=function(){var a=[];"undefined"==typeof Array.randomize&&(Array.prototype.randomize=function(){return Arrays.randomize(this)},a.push("randomize")),"undefined"==typeof Array.removeDuplicates&&(Array.prototype.removeDuplicates=function(a){return Arrays.removeDuplicates(this)},a.push("removeDuplicates")),"undefined"==typeof Array.contains&&(Array.prototype.contains=function(a){return Arrays.contains(this,a)},a.push("contains")),"undefined"==typeof Array.remove&&(Array.prototype.remove=function(a,b){return Arrays.remove(this,a,b)},a.push("remove")),"undefined"==typeof Array.indexOf&&(Array.prototype.indexOf=b,a.push("indexOf")),"undefined"==typeof Array.remove&&(Array.prototype.remove=function(a,b){return Arrays.remove(this,a,b)},a.push("remove")),"undefined"==typeof Array.clone&&(Array.prototype.clone=function(){return Arrays.clone(this)},a.push("clone")),console&&(console.info?console.info("Array er udvidet med "+a):console.log&&console.log("Array er udvidet med "+a))};var b=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=c<0?Math.ceil(c):Math.floor(c),c<0&&(c+=b);c<b;c++)if(c in this&&this[c]===a)return c;return-1};return a}(),Objects=Objects||function(){var a=new Object;a.clone=function(b){var c;if(null==b||"object"!=typeof b)return b;if(b instanceof Date)return c=new Date,c.setTime(b.getTime()),c;if(Array.isArray(b))return b.slice(0);if(b instanceof Object){c={};for(var d in b)b.hasOwnProperty(d)&&(c[d]=a.clone(b[d]));return c}throw new Error("Unable to clone obj! Its type isn't supported.")},a.combine=function(b,c){for(var d={},e=0;e<b.length;e++)if(b[e]&&"object"==typeof b[e]&&!Array.isArray(b[e]))for(var f in b[e])b[e].hasOwnProperty(f)&&(d[f]=1==c?a.clone(b[e][f]):b[e][f]);else if(console){var g=b[e]+" kan ikke combines";console.warn?console.warn(g):console.log&&console.log(g)}return d},a.difference=function(a,c,d){for(var e=0,f=0,g=[],h=[];f<a.length&&e<c.length;)if(a[f][d]==c[e][d])previousElement=c[e],e++,f++;else{var i=b(c,a[f],d,e);if(i==-1)h.push({element:a[f]}),f++;else for(;e<i;)g.push({element:c[e],previousElement:e>0?c[e-1]:null,nextElement:e+1<c.length?c[e+1]:null}),e++}for(;e<c.length;)g.push({element:c[e],previousElement:e>0?c[e-1]:null,nextElement:e+1<c.length?c[e+1]:null}),e++;for(;f<a.length;)h.push({element:a[f]}),f++;return{added:g,deleted:h}};var b=function(a,b,c,d){for(var e=d;e<a.length;e++)if(a[e][c]==b[c])return e;return-1};return a.addNonSupportedObjectCreate=function(){"function"!=typeof Object.create&&(Object.create=function(){var a=function(){};return function(b){if(arguments.length>1)throw Error("Second argument not supported");if(b!==Object(b)&&null!==b)throw TypeError("Argument must be an object or null");if(null===b)throw Error("null [[Prototype]] not supported");a.prototype=b;var c=new a;return a.prototype=null,c}}())},a.isEqual=function(){function a(b,c){var f;if(isNaN(b)&&isNaN(c)&&"number"==typeof b&&"number"==typeof c)return!0;if(b===c)return!0;if("function"==typeof b&&"function"==typeof c||b instanceof Date&&c instanceof Date||b instanceof RegExp&&c instanceof RegExp||b instanceof String&&c instanceof String||b instanceof Number&&c instanceof Number)return b.toString()===c.toString();if(!(b instanceof Object&&c instanceof Object))return!1;if(b.isPrototypeOf(c)||c.isPrototypeOf(b))return!1;if(b.constructor!==c.constructor)return!1;if(b.prototype!==c.prototype)return!1;if(d.indexOf(b)>-1||e.indexOf(c)>-1)return!1;for(f in c){if(c.hasOwnProperty(f)!==b.hasOwnProperty(f))return!1;if(typeof c[f]!=typeof b[f])return!1}for(f in b){if(c.hasOwnProperty(f)!==b.hasOwnProperty(f))return!1;if(typeof c[f]!=typeof b[f])return!1;switch(typeof b[f]){case"object":case"function":if(d.push(b),e.push(c),!a(b[f],c[f]))return!1;d.pop(),e.pop();break;default:if(b[f]!==c[f])return!1}}return!0}var b,c,d,e;if(arguments.length<1)return!0;for(b=1,c=arguments.length;b<c;b++)if(d=[],e=[],!a(arguments[0],arguments[b]))return!1;return!0},a}(),Strings=Strings||function(){var a=new Object;return a.hasText=function(a){var b=Strings.removeExtraWhitespace(a,!0);return!!b.length},a.removeExtraWhitespace=function(a,b){if(b=null!=b&&b,null==a)return"";var c=Strings.trim(a);return c.replace(/\s+/g,b?"":" ")},a.trim=function(a,b){return null==a?"":(null==b&&(b="\\s"),Strings.trimStart(Strings.trimEnd(a,b),b))},a.trimStart=function(a,b){if(null==a)return"";null==b&&(b="\\s");var c=new RegExp("^"+b+"+","g");return a.replace(c,"")},a.trimEnd=function(a,b){if(null==a)return"";null==b&&(b="\\s");var c=new RegExp(b+"+$","g");return a.replace(c,"")},a.contains=function(a,b){return null!=a&&a.indexOf(b)!=-1},a.capitaliseFirstSentenceLetter=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},a.capitaliseFirstWordLetter=function(a){for(var b=a.split(" "),c=0,d=b.length;c<d;c++)b[c]=Strings.capitaliseFirstSentenceLetter(word[c]);return string.charAt(0).toUpperCase()+string.slice(1)},a.extendString=function(){var a=[];String.prototype.trim=function(a){return Strings.trim(this,a)},a.push("trim"),"undefined"==typeof String.trimEnd&&(String.prototype.trimEnd=function(a){return Strings.trimEnd(this,a)},a.push("trimEnd")),"undefined"==typeof String.trimStart&&(String.prototype.trimStart=function(a){return Strings.trimStart(this,a)},a.push("trimStart")),console&&(console.info?console.info("String er udvidet med "+a):console.log&&console.log("String er udvidet med "+a))},a}(),XmlNode=XmlNode||function(){var a={};return a.name="",a.attributes="",a.length=0,a._nodeValue="",Object.defineProperty(a,"nodeValue",{get:function(){return this._nodeValue},set:function(a){for(;a.indexOf("  ")!=-1;)a=a.replace(/\s\s+/g," ");this._nodeValue=Strings.trim(a),this.length=this._nodeValue.length}}),a.getAsHtml=function(a,b){null==a&&(a=""),null==b&&(b=!1);var c="";return b&&""==this.attributes&&""==this.nodeValue.replace(/\s/g,"")&&"br"!=this.name&&"img"!=this.name?c:c=""==a&&""==this.name?this.nodeValue:"br"==this.name||"img"==this.name?"<"+this.name+" "+this.attributes+"/>":"<"+(""==this.name?a:this.name)+" "+this.attributes+">"+this.nodeValue+"</"+(""==this.name?a:this.name)+">"},a.clone=function(){var a=Object.create(XmlNode);return a.attributes=this.attributes,a.name=this.name,a.nodeValue=this.nodeValue,a},a}(),XmlUtil=XmlUtil||function(){var a=new Object;return a.concatXmlNodeArray=function(b,c){return b.nodeValue=a.concatXmlNodeArrayHtml(c),b},a.concatXmlNodeArrayHtml=function(a,b,c){c=void 0!=c?c:a.length-1;for(var d="",e=0;e<=c;e++)d+=a[e].getAsHtml(b,!0);return d},a.splitXml=function(b){var c,d,e,f=a.formatHtml(b).split("<"),g=new Array,h=0,i=Object.create(XmlNode);for(e=0,l=f.length;e<l;e++)""==f[e].replace(/ /g,"")||(0==f[e].indexOf("/")?(h--,0==h?(i.nodeValue=i.nodeValue.replace(/^\s/g,"").replace(/\s+$/g,""),g.push(i),i=Object.create(XmlNode),i.nodeValue+=f[e].substring(f[e].indexOf(">")+1)):i.nodeValue+=" <"+f[e]):f[e].indexOf("/>")!=-1?0==h?(c=f[e].substring(0,f[e].indexOf("/>")),c.indexOf(" ")!=-1&&(i.attributes=c.substr(c.indexOf(" ")),c=c.substr(0,c.indexOf(" "))),i.name=c.toLowerCase(),g.push(i),i=Object.create(XmlNode),f[e]=f[e].substring(f[e].indexOf("/>")+2),e--):i.nodeValue+=" <"+f[e]:f[e].indexOf(">")==-1?(i.nodeValue+=f[e],i.nodeValue=i.nodeValue.replace(/^\s/g,"").replace(/\s+$/g,""),g.push(i),i=Object.create(XmlNode)):(0==h?(c=f[e].substr(0,f[e].indexOf(">")),d="",c.indexOf(" ")!=-1&&(i.attributes=c.substr(c.indexOf(" ")),c=c.substr(0,c.indexOf(" "))),i.name=c.toLowerCase(),i.nodeValue+=f[e].substring(f[e].indexOf(">")+1)):i.nodeValue+=" <"+f[e],h++));return""!=i.nodeValue.replace(/ /g,"")&&(i.nodeValue=i.nodeValue.replace(/^\s/g,"").replace(/\s+$/g,""),g.push(i)),g},a.formatHtml=function(a){for(var b=["img([^>]*[^/])","br[^>/]*","hr[^>/]*"],c=0;c<b.length;c++){var d=new RegExp("<"+b[c]+">","gi"),e=a.match(d);if(null!=e)for(var f=0;f<e.length;f++)a=a.replace(e[f],e[f].replace(">","/>"))}return a=a.replace(/\n/g," ").replace(/\t/g," "),a=a.replace(/\s\s+/g," ")},a}(),UUID=UUID||function(){function a(a){return(new Array(a).join(0)+parseInt(Math.pow(2,4*a)*Math.random()).toString(16)).slice(-a)}var b=new Object,c={};return b.divider="-",b.get=function(d){null!=d&&(b.divider=d);for(var e;c[e=a(8)+b.divider+a(4)+b.divider+a(4)+b.divider+a(12)];);return c[e]=1,e},b}();!function(){var a=function(){this._listeners={},this._oneListeners={},this._name="Event"};a.prototype.on=function(a,b){if(null==a||null==b)throw new Error("type eller listener er null i "+this._name);"undefined"==typeof this._listeners[a]&&(this._listeners[a]=[]);for(var c=!1,d=0,e=this._listeners[a].length;d<e;d++)if(this._listeners[a][d]===b){c=!0;break}c||this._listeners[a].push(b)},a.prototype.one=function(a,b){if(null==a||null==b)throw new Error("type eller listener er null i "+this._name);"undefined"==typeof this._listeners[a]&&(this._listeners[a]=[]),"undefined"==typeof this._oneListeners[a]&&(this._oneListeners[a]=[]);for(var c=!1,d=0,e=this._listeners[a].length;d<e;d++)if(this._listeners[a][d]===b){c=!0;break}console.log(this._oneListeners[a]),c||(this._listeners[a].push(b),this._oneListeners[a].push(b))},a.prototype.fire=function(a){if("string"==typeof a&&(a={type:a,target:this}),a.target||(a.target=this),!a.type)throw new Error("Event object missing 'type' property.");if(this._listeners[a.type]instanceof Array)for(var b=this._listeners[a.type],c=0,d=b.length;c<d;c++){var e=b[c];if(e.call(this,a),"undefined"!=typeof this._oneListeners[a.type]){for(var f=!1,g=0,h=this._oneListeners[a.type].length;g<h;g++)if(this._oneListeners[a.type][g]===e){f=!0;break}f&&this.off(a.type,e)}}},a.prototype.off=function(a,b){if(this._listeners[a]instanceof Array){b||(this._listeners[a]=[]);for(var c=this._listeners[a],d=0,e=c.length;d<e;d++)if(c[d]===b){c.splice(d,1);break}}},window.Event=a}();var HtmlInColumns=HtmlInColumns||function(){"use strict";for(var a=["jQuery","UUID","XmlNode","XmlUtil","Arrays","Objects","Event"],b=0;b<a.length;b++)if("undefined"==typeof window[a[b]])throw new Error("HtmlInColumns relies on '"+a[b]+"' which cant be found. Please add it to the html (before HtmlInColumns).");var c=new Event;return c.options={},c.defaults={containerID:"#Container",columnClass:"spalte",protectAgainstOrphans:!0},c.nonLastTag=["h1","h2","h3","h4","h5","h6"],c.nonSplitTag=["li","tr","div"],c.orphansLength=60,Object.defineProperty(c,"RENDERED",{value:"onRendered",writeable:!1}),c.columnWidth=NaN,c.columnMargin=NaN,c.extraHeightMargin=0,c.uuid,c.columnID,c.columnCount=1,c.columnMaxHeight=0,c.maxHeight=0,c.altHtml,c.averageLetterCount,c.columnLetterCount,c.isRunning=!1,c.abortRenderAndReRender=!1,c.urenderedeHtmlNoder,c.olLiCount=0,c.lastRenderHeight=0,c.loadCount,c.init=function(a){this.uuid=UUID.get("_")+"_",this.options=Objects.combine([this.defaults,a]),Arrays.extendArray(),this.altHtml=$(this.options.containerID).html(),Logger.useScreenLog=!1,$(this.options.containerID).html(""),$(this.options.containerID).show(),$(window).resize(this.onResize.bind(this))},c.onResize=function(){Math.abs(this.lastRenderHeight-window.innerHeight)>3&&this.render()},c.render=function(){if(null==this.altHtml)throw new Error("Intet html. Er init blevet kaldt?");return this.isRunning?void(this.abortRenderAndReRender=!0):(this.isRunning=!0,this.lastRenderHeight=window.innerHeight,Logger.startStopwatch(),this.columnMaxHeight=0,this.averageLetterCount=0,this.columnLetterCount=0,$(this.options.containerID).html(""),this.maxHeight=$(this.options.containerID).height()-this.extraHeightMargin,this.columnCount=0,this.urenderedeHtmlNoder=XmlUtil.splitXml(this.altHtml),this.renderNextColumn(),void $(this.options.containerID+" .spalte").height(this.columnMaxHeight))},c.reRender=function(){this.abortRenderAndReRender=!1,this.isRunning=!1,this.render()},c.renderNextColumn=function(){if(this.abortRenderAndReRender)return void setTimeout(this.reRender.bind(this),50);var a,b;this.columnID=this.createNewColumn(this.columnCount);for(var c=0==this.columnCount?0:this.columnLetterCount/this.columnCount,d=0,e=0;e<c&&this.urenderedeHtmlNoder.length>d;)e+=this.urenderedeHtmlNoder[d].length,d++;a=this.handleOLTags(this.handleNonLastTags(this.findColumnContent(this.urenderedeHtmlNoder,d,"p"))),0==a.added.length&&a.remaining.length>0&&a.added.push(a.remaining.shift()),this.urenderedeHtmlNoder=a.remaining,this.finishColumn(XmlUtil.concatXmlNodeArrayHtml(a.added));for(var b=0;b<a.added.length;b++)this.columnLetterCount+=a.added[b].length;this.urenderedeHtmlNoder.length>0?setTimeout(this.renderNextColumn.bind(this),0):(Logger.logStopwatch("end"),this.preLoadImages(),this.isRunning=!1,this.abortRenderAndReRender=!1,this.fire({type:this.RENDERED,width:$(this.options.containerID).width()}))},c.handleOLTags=function(a){var b=a.added.length;if(b>0&&"ol"==a.added[b-1].name){for(var c=XmlUtil.splitXml(a.added[b-1].nodeValue),d=c.length-1,e=1;"li"==c[d].name&&d>0;)d--,e++;this.olLiCount=e+1}return 0!=this.olLiCount&&a.remaining.length>0&&"ol"==a.remaining[0].name&&(a.remaining[0].attributes+=' start="'+this.olLiCount+'" ',this.olLiCount=0),a},c.handleNonLastTags=function(a){for(;a.added.length>0&&this.nonLastTag.indexOf(a.added[a.added.length-1].name)!=-1;)a.remaining.unshift(a.added.pop());return a},c.handleOrphans=function(a){return this.options.protectAgainstOrphans&&(a.remaining.length<this.orphansLength&&(a.added+=" "+a.remaining,a.remaining=""),a.added.length<this.orphansLength&&(a.remaining=a.added+" "+a.remaining,a.added="")),a},c.findColumnContent=function(a,b,c,d,e,f){null==c&&(c=""),null==e&&(e=""),null==f&&(f=""),null==d&&(d=""),(!b||b<0)&&(b=0),b>a.length-1&&(b=a.length-1);var g,h,i,j;for(h=g=0;a.length>b&&b>=0&&(g==h||0==h);)h=g,i=XmlUtil.concatXmlNodeArrayHtml(a,c,b),g=this.testHeight(d+e+i+f),b+=g;b<-1&&(b=-1),1==g&&a.length!=b&&b--;var k={added:a.slice(0,b+1),remaining:a.slice(b+1)};if(k.remaining.length>0){var l=k.remaining[0],m=l.clone(),n=XmlUtil.splitXml(l.nodeValue);if(this.nonSplitTag.indexOf(l.name)==-1){var o=XmlUtil.concatXmlNodeArrayHtml(k.added);if(1==n.length&&""==n[0].name){m=l.clone();var p=this.findTextContent(n[0],d+o,e+"<"+l.name+" "+l.attributes+">","</"+l.name+">"+f);Strings.hasText(p.added)&&(m.nodeValue=p.added,k.added.push(m),k.remaining[0].nodeValue=p.remaining)}else j=this.findColumnContent(n,0,"",d+o,e+"<"+l.name+" "+l.attributes+">","</"+l.name+">"+f),j.added.length>0&&(m.nodeValue=XmlUtil.concatXmlNodeArrayHtml(j.added),k.added.push(m),k.remaining[0].nodeValue=XmlUtil.concatXmlNodeArrayHtml(j.remaining))}}return k},c.findTextContent=function(a,b,c,d){var e,f,g,h,i;h=f=e=0,g="",i=a.nodeValue.split(" "),$("#"+this.columnID).html(b);var j=$("#"+this.columnID).height();$("#"+this.columnID).html(c+a.nodeValue+d);var k=$("#"+this.columnID).height(),l=(this.maxHeight-j)/k;for(l<1&&(h=Math.floor(i.length*l));i.length>h&&h>=0&&(e==f||0==f);)f=e,g=i.slice(0,h).join(" "),e=this.testHeight(b+c+g+d),h+=e;h<0&&(h=0),1==e&&i.length!=h&&h--;var m={added:i.slice(0,h).join(" "),remaining:i.slice(h).join(" ")};return this.handleOrphans(m)},c.testHeight=function(a){return $("#"+this.columnID).html(a),$("#"+this.columnID).height()>this.maxHeight?-1:1},c.finishColumn=function(a){isNaN(this.columnWidth)&&(this.columnWidth=$("#"+this.columnID).width()),$("#"+this.columnID).html(this.updateImgTag(a.replace(/^ *<br\/>/g,"").replace(/$<br\/> */g,""),this.columnWidth,this.columnID)),isNaN(this.columnMargin)&&(this.columnMargin=parseInt($("#"+this.columnID).css("margin-left").replace("px",""))+parseInt($("#"+this.columnID).css("margin-right").replace("px",""))+parseInt($("#"+this.columnID).css("padding-right").replace("px",""))+parseInt($("#"+this.columnID).css("padding-left").replace("px",""))+parseInt($("#"+this.columnID).css("border-right-width").replace("px",""))+parseInt($("#"+this.columnID).css("border-left-width").replace("px",""))),this.columnMaxHeight=Math.max($("#"+this.columnID).height(),this.columnMaxHeight),this.columnCount++,$(this.options.containerID).css({width:(this.columnWidth+this.columnMargin)*this.columnCount})},c.allImages=[],c.updateImgTag=function(a,b,c){for(var d=new RegExp("<img","gi"),e=new RegExp('s*srcs*=s*"[0-9a-åA-å./:?=]*"',"gi"),f=new RegExp('s*srcs*=s*"',"gi"),g=a.split(d),h=1;h<g.length;h++){var i=g[h].match(e);if(null!=i&&1==i.length){var j=i[0],k=j.replace(f,"").replace('"',"").replace(/\s+/g,"");this.allImages.push({src:k,columnID:c})}g[h]=' width="'+b+'" id="pic-'+c+"-"+h+'"'+g[h]}return g.join("<img")},c.preLoadImages=function(){this.loadCount=this.allImages.length;for(var a=0;a<this.allImages.length;a++)this.allImages[a].img=new Image,this.allImages[a].img.onload=this.picLoaded.bind(this),this.allImages[a].img.src=this.allImages[a].src},c.picLoaded=function(){var a=50;if(this.loadCount--,0==this.loadCount)for(var b=0;b<this.allImages.length;b++){var c=$("#"+this.allImages[b].columnID).height()-a;if(c>this.columnMaxHeight||c>this.maxHeight){var d=$("#"+this.allImages[b].columnID).html();if(0!=d.indexOf("<img")||d.split(">").length>2){this.reRender();break}}}},c.createNewColumn=function(a){var b=this.uuid+a,c='<div id="'+b+'" class="'+this.options.columnClass+'"></div>';return $(this.options.containerID).append(c),b},c}();